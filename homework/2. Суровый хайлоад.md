# Часть 2: Суровый хайлоад

В этой части задания вы познакомитесь с работой достаточно большой базы под достаточно большой нагрузкой. Потренируетесь в тех приемах, которые делать при этом можно и поймете, почему некоторые вещи делать нельзя.

Итак, стартап подрос и набрал как базу резюме/вакансий, так и рпс. И случилось так, что вашим стартапом была куплена база конкурента. Ваша задача - залить в базу (вашу) большое количество новых данных, сохраняя при этом отзывчивость базы.

Что нужно сделать:
1) Нагенерить SQL-скриптом рандомных реалистичных данных (имитируем купленную базу) и сложить их в какие-нибудь таблицы рядом с основными. Порядок количества данных - 2-3М резюме, 1М вакансий, 10М откликов/приглашений/сообщений, остальное подберите сами.
2) Небольшими транзакциями перекачать эти данные в основные таблицы (см. ниже)
3) Убедиться, что с таким количеством данных все запросы выполняются оптимальным образом


Для выполнения пункта (2) ваши коллеги подготовили скрипт на python. Выглядит этот скрипт так: 
```python
while (allDataTransfered()):
    transferBatch()
```
Если потребуется что-то более сложное - ю а велкам. Здесь каждая функция идет в базу и выполняет соответствующий SQL-скрипт. Оба скрипта (или сколько там их вам потребуется) вам предстоит написать.
Так как база живет под большой нагрузкой, в ходе выполнения каждой транзакции вам нельзя апдейтить более N строк рабочих таблиц (N = 10000, можно считать постоянным)

Результат этого этапа:
1) Файл с SQL-скриптом, генерирующим купленную базу (а также создающим под нее таблицы и все такое)
2) Если для пункта (2) вам потребуется свой python-скрипт - его тоже присылайте
3) Файлы с SQL-скриптами, которые будут запускаться Python-скриптом
4) Файл с SQL-скриптом из первого этапа, создающим схему вашей БД (с необходимыми изменениями)
5) Файл со сценариями из первого этапа. Запросы в нем должны быть дополнены EXPLAIN ANALYZE-ами, выполненными после закачивания всех данных.

Замечания:

0) Все скрипты должны работать правильно при любом консистентном состоянии рабочей базы, т.е. скрипт (любой) должен отработать правильно, если:
    * Перед началом работы скрипта в базе что-нибудь лежит (консистентное и не нарушающее бизнес-логику)
    * Параллельно с выполнением скрипта на рабочей базе выполняются другие операции (консистентные и не нарушающие бизнес-логику)
1) Не забываем про VACUUM ANALYZE (запускайте его после наполнения базы большими данными и/или при создании индексов)
2) С таблицами с купленной базой можно делать все, что угодно. Под нагрузкой находятся только рабочие таблицы.
3) Не должно быть никаких seq scan-ов по рабочим таблицам (а также по любым таблицам, если в транзакции блокируются строки рабочих таблиц)
4) Этот список будет дополняться


